var GridPlusSetting=GridPlusSetting||{};!function(h){"use strict";GridPlusSetting={vars:{grid_stack:h(".grid-stack"),custom_content_numb:0},init:function(){h(".grid-plus-wrap").css("opacity",1),GridPlusSetting.grid=null,GridPlusSetting.is_search=0,GridPlusSetting.options={cellHeight:10,verticalMargin:20,height:0,animate:!0,acceptWidgets:!0,removable:!0,width:12,resizable:{handles:"e, se, s, sw, w"}},GridPlusSetting.select_categories=null,GridPlusSetting.initControl(),GridPlusSetting.registerEvent(),GridPlusSetting.animation(),GridPlusSetting.initDepend(),GridPlusSetting.initSaveCtrS(),GridPlusSetting.registerGallery(),new Clipboard(".copy-clipboard").on("success",function(t){0<h(t.trigger).find("i.fa-check").length&&h(t.trigger).find("i.fa-check").remove(),h(t.trigger).append('<i class="fa fa-check active"> Copied!</i>'),t.clearSelection(),setTimeout(function(){h("i.active",t.trigger).fadeOut(function(){h(this).remove()})},2e3)}),h(".colorpicker").wpColorPicker(),GridPlusSetting.layout_custom_css=ace.edit("layout_custom_css"),GridPlusSetting.layout_custom_css.getSession().setMode("ace/mode/css"),GridPlusSetting.layout_custom_css.setAutoScrollEditorIntoView(!0),"undefined"!=typeof grid_script_data&&""!=grid_script_data.grid_id&&GridPlusSetting.processEditLayout(),GridPlusSetting.execCustomContent()},initControl:function(){GridPlusSetting.layout_id=h("#layout_id"),GridPlusSetting.layout_shortcode=h("#layout_shortcode"),GridPlusSetting.layout_name=h("#layout_name"),GridPlusSetting.layout_type=h("#layout_type"),GridPlusSetting.layout_col=h("#layout_col"),GridPlusSetting.layout_gutter=h("#layout_gutter"),GridPlusSetting.layout_item_per_page=h("#layout_item_per_page"),GridPlusSetting.layout_total_items=h("#layout_total_items"),GridPlusSetting.layout_fix_item_height=h("#layout_fix_item_height"),GridPlusSetting.layout_crop_image=h("#layout_crop_image"),GridPlusSetting.layout_disable_link=h("#layout_disable_link"),GridPlusSetting.layout_custom_content_enable=h("#layout_custom_content_enable"),GridPlusSetting.layout_custom_content=h("#layout_custom_content"),GridPlusSetting.layout_carousel_rtl=h("#layout_carousel_rtl"),GridPlusSetting.layout_carousel_total_items=h("#layout_carousel_total_items"),GridPlusSetting.layout_carousel_desktop_large_col=h("#layout_carousel_desktop_large_col"),GridPlusSetting.layout_carousel_desktop_large_width=h("#layout_carousel_desktop_large_width"),GridPlusSetting.layout_carousel_desktop_medium_col=h("#layout_carousel_desktop_medium_col"),GridPlusSetting.layout_carousel_desktop_medium_width=h("#layout_carousel_desktop_medium_width"),GridPlusSetting.layout_carousel_desktop_small_col=h("#layout_carousel_desktop_small_col"),GridPlusSetting.layout_carousel_desktop_small_width=h("#layout_carousel_desktop_small_width"),GridPlusSetting.layout_carousel_tablet_col=h("#layout_carousel_tablet_col"),GridPlusSetting.layout_carousel_tablet_width=h("#layout_carousel_tablet_width"),GridPlusSetting.layout_carousel_tablet_small_col=h("#layout_carousel_tablet_small_col"),GridPlusSetting.layout_carousel_tablet_small_width=h("#layout_carousel_tablet_small_width"),GridPlusSetting.layout_carousel_mobile_col=h("#layout_carousel_mobile_col"),GridPlusSetting.layout_carousel_mobile_width=h("#layout_carousel_mobile_width"),GridPlusSetting.layout_carousel_next_text=h("#layout_carousel_next_text"),GridPlusSetting.layout_carousel_prev_text=h("#layout_carousel_prev_text"),GridPlusSetting.layout_carousel_width_ratio=h("#layout_carousel_width_ratio"),GridPlusSetting.layout_carousel_height_ratio=h("#layout_carousel_height_ratio"),GridPlusSetting.layout_loop=h("#layout_loop"),GridPlusSetting.layout_center=h("#layout_center"),GridPlusSetting.layout_autoplay=h("#layout_autoplay"),GridPlusSetting.layout_autoplay_hover_pause=h("#layout_autoplay_hover_pause"),GridPlusSetting.layout_autoplay_time=h("#layout_autoplay_time"),GridPlusSetting.layout_show_dot=h("#layout_show_dot"),GridPlusSetting.layout_show_nav=h("#layout_show_nav"),GridPlusSetting.layout_carousel_nav_position=h("#layout_carousel_nav_position"),GridPlusSetting.layout_carousel_nav_style=h("#layout_carousel_nav_style"),GridPlusSetting.layout_justified_row_height=h("#layout_justified_row_height"),GridPlusSetting.layout_source=h("#layout_source"),GridPlusSetting.source_type=h("#source_type"),GridPlusSetting.attachment_type=h("#attachment_type"),GridPlusSetting.grid_gallery=h("#grid_gallery"),GridPlusSetting.custom_urls=h("#custom_urls"),GridPlusSetting.layout_category=h("#layout_category"),GridPlusSetting.layout_show_category=h("#layout_show_category"),GridPlusSetting.layout_cate_multi_line=h("#layout_cate_multi_line"),GridPlusSetting.layout_authors=h("#layout_authors"),GridPlusSetting.layout_include_ids=h("#layout_include_ids"),GridPlusSetting.layout_exclude_ids=h("#layout_exclude_ids"),GridPlusSetting.layout_order=h("#layout_order"),GridPlusSetting.layout_order_by=h("#layout_order_by"),GridPlusSetting.layout_category_color=h("#layout_category_color"),GridPlusSetting.layout_category_hover_color=h("#layout_category_hover_color"),GridPlusSetting.layout_no_image_bg_color=h("#layout_no_image_bg_color"),GridPlusSetting.layout_bg_color=h("#layout_bg_color"),GridPlusSetting.layout_icon_color=h("#layout_icon_color"),GridPlusSetting.layout_icon_hover_color=h("#layout_icon_hover_color"),GridPlusSetting.layout_title_color=h("#layout_title_color"),GridPlusSetting.layout_title_hover_color=h("#layout_title_hover_color"),GridPlusSetting.layout_excerpt_color=h("#layout_excerpt_color"),GridPlusSetting.layout_animation_type=h("#layout_animation_type"),GridPlusSetting.layout_pagination_type=h("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=h("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=h("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=h("#layout_page_loadmore_text"),"metro"==GridPlusSetting.layout_type.val()&&(GridPlusSetting.layout_item_per_page=h("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=h("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=h("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=h("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=h("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=h("#metro_layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=h("#attachment_layout_authors"),GridPlusSetting.layout_order=h("#attachment_layout_order"),GridPlusSetting.layout_order_by=h("#attachment_layout_order_by")),h("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(h('optgroup[data-post-type="'+GridPlusSetting.layout_source.val()+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize()},initGridMoveAndResize:function(t){void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid&&("grid"!=t&&"masonry"!=t||GridPlusSetting.grid.disable(),"metro"==t&&GridPlusSetting.grid.enable()),"grid"==t?h(".change-ratio",".action-groups").show():h(".change-ratio",".action-groups").hide(),"metro"==t?h(".change-item-ratio",".grid-stack-item").show():h(".change-item-ratio",".grid-stack-item").hide()},registerEvent:function(){h("a.add-item").on("click",function(){GridPlusSetting.showPopupSkin(function(t){var i=GridPlusSetting.estimateItemInfo(),e=i.width,a=i.height,l=i.system_col,r=i.col;GridPlusSetting.options.width=l,GridPlusSetting.grid.setGridWidth(l,!1),GridPlusSetting.processAddItem(e,a,r,t),GridPlusSetting.processUpdateItemPerPage(1)})}),h("a.change-item-style").on("click",function(){GridPlusSetting.showPopupSkin(function(t){h(".grid-stack-item").each(function(){GridPlusSetting.processInitItemStyle(h(this),t)})})}),h("a.save-layout",".grid-plus-container").off("click").on("click",function(){GridPlusSetting.processSaveGrid(this)}),h(".grid-post-item",".list-skins").each(function(){h(this).append('<a class="select-skin" href="javascript:;"><i class="fa fa-square-o"></i>Select</a>'),h("a.select-skin",this).off("click").on("click",function(){h("a.select-skin").html('<i class="fa fa-square-o"></i>Select'),h(this).html('<i class="fa fa-check-square-o"></i>Selected'),h(".grid-post-item",".list-skins").attr("data-skin-selected",0),h(this).parent().attr("data-skin-selected",1)})}),h("a.generate-layout").on("click",function(){GridPlusUtil.showLoading("Processing generate layout ..."),GridPlusSetting.vars.grid_stack.fadeOut(function(){GridPlusSetting.processGenerateLayout(),GridPlusSetting.vars.grid_stack.fadeIn(function(){GridPlusUtil.closeLoading(0)})})}),h("a.search-layout").on("click",function(){var t=h("input",h(this).parent());t.hasClass("active")?t.removeClass("active"):(t.val(""),t.addClass("active"),setTimeout(function(){t.focus(),t.attr("placeholder","Type grid name and enter to search")},300)),h(t).on("keypress",function(t){if("13"==(t.keyCode?t.keyCode:t.which)){var i=h(this).parent().parent().attr("data-ajax-url"),e=h(this).val();0==GridPlusSetting.is_search&&(GridPlusSetting.is_search=1,GridPlusSetting.processSearch("Searching grid ......",i,e))}})}),h(".refresh-layout").on("click",function(){if(0==GridPlusSetting.is_search){GridPlusSetting.is_search=1;var t=h(this).parent().attr("data-ajax-url");GridPlusSetting.processSearch("Refresh grid ......",t,"")}}),h(".change-ratio",".action-groups").on("click",function(){var t=wp.template("bg-prompt-change-height-dialog"),i=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),e=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==i&&""!=i||(i=1),void 0!==e&&""!=e||(e=1),h("body").append(t({height_ratio:i,width_ratio:e})),h("a.close-popup",".bg-popup-change-height").on("click",function(){h(".bg-popup-change-height").remove()}),h(".apply-change-height").on("click",function(){var t=h(".txt_height",".bg-popup-change-height").val(),i=h(".txt_width",".bg-popup-change-height").val(),e=h(".grid-stack-item-content",".grid-stack-item:first-child").width(),a=0;t=parseInt(t)<=0?1:t,i=parseInt(i)<=0?1:i,""!=t&&""!=i&&(GridPlusSetting.vars.grid_stack.attr("data-height-ratio",t),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",i),e=parseInt(e),t=parseInt(t),i=parseInt(i),a=Math.floor(e*(t/i))/GridPlusSetting.options.cellHeight,GridPlusSetting.processChangeHeight(a)),h(".bg-popup-change-height").remove()})}),GridPlusSetting.layout_name.keyup(function(){GridPlusSetting.layout_shortcode.text('[grid_plus name="'+h(this).val()+'"]')}),GridPlusSetting.registerChangeTab()},initSelectize:function(){var t,i={plugins:["remove_button","drag_drop"],searchField:"text",delimiter:",",persist:!1};h("select:not(.manual)",".grid-plus-wrap").each(function(){t=h(this).attr("data-selected"),i.items=void 0!==t?t.split(","):[],h(this).selectize(i)}),t=GridPlusSetting.layout_category.attr("data-selected"),i.items=void 0!==t?t.split(","):[],GridPlusSetting.select_categories=GridPlusSetting.layout_category.selectize(i),void 0!==GridPlusSetting.select_categories[0]&&(GridPlusSetting.select_categories=GridPlusSetting.select_categories[0].selectize),GridPlusSetting.layout_exclude_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(t,i){if(!t.length)return i();h.ajax({url:GridPlusSetting.layout_exclude_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:t,post_type:GridPlusSetting.layout_source.val()},error:function(){i()},success:function(t){i(h.parseJSON(t))}})}}),GridPlusSetting.layout_include_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(t,i){if(!t.length)return i();h.ajax({url:GridPlusSetting.layout_include_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:t,post_type:GridPlusSetting.layout_source.val()},error:function(){i()},success:function(t){i(h.parseJSON(t))}})}}),GridPlusSetting.layout_custom_content.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(t,i){if(!t.length)return i();h.ajax({url:GridPlusSetting.layout_custom_content.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:t,post_type:GridPlusSetting.layout_custom_content.attr("data-post-type")},error:function(){i()},success:function(t){i(h.parseJSON(t))}})}})},initSaveCtrS:function(){h(window).bind("keydown",function(t){if((t.ctrlKey||t.metaKey)&&"s"===String.fromCharCode(t.which).toLowerCase())return t.preventDefault(),h("a.save-layout","#layout-config").trigger("click"),!1})},initDepend:function(){h("[data-depend-control]").each(function(){var t=h(this).attr("data-depend-control"),i=h("#"+t),e="",a=","+h(this).attr("data-depend-value")+",",l=","+h(this).attr("data-depend-dif-value")+",";void 0!==i&&0<i.length&&(e=i.val(),i.is(":checkbox")&&(e=i.is(":checked")),i.is(":radio")&&(e=h("#"+t+":checked").val()),0<=a.indexOf(","+e+",")?h(this).css({display:"inline-block"}):",undefined,"!=l&&l.indexOf(","+e+",")<0?h(this).css({display:"inline-block"}):h(this).css({display:"none"}),i.off("change").on("change",function(t){if(t.preventDefault(),"layout_type"!=h(this).attr("id")&&"layout_custom_content_enable"!=h(this).attr("id")||GridPlusSetting.execCustomContent(),"layout_type"==h(this).attr("id")){var i=h(this).val();"grid"==i?h(".change-ratio",".action-groups").show():h(".change-ratio",".action-groups").hide(),"metro"==i?h(".change-item-ratio",".grid-stack-item").show():h(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.initGridMoveAndResize(i)}if("layout_source"==h(this).attr("id")){var e=h(this).val();GridPlusSetting.select_categories.destroy(),h("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(h('optgroup[data-post-type="'+e+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize()}GridPlusSetting.initDepend()}))})},initGridStack:function(t,i,e,a){h('select[name="padding"]').val();var l=GridPlusSetting.estimateItemInfo(),r=l.width,o=l.height,s=l.system_col;a=parseInt(a),GridPlusSetting.options.verticalMargin=a,GridPlusSetting.options.width=s,GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+a),GridPlusSetting.vars.grid_stack.attr("data-layout",t),GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(a,!0),GridPlusSetting.grid.removeAll();for(var n=0;n<e;n++)GridPlusSetting.processAddItem(r,o,i)},initGridStackEdit:function(t,i,e,a,l,r){var o=GridStackUI.Utils.sort(t,1),s=null;GridPlusSetting.vars.grid_stack.attr("data-height-ratio",a),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",l),GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+i),GridPlusSetting.vars.grid_stack.attr("data-layout",r),"grid"==r||"masonry"==r||5==e?(GridPlusSetting.options.width=e,GridPlusSetting.vars.grid_stack.addClass("grid-stack-"+e)):GridPlusSetting.options.width=12,"metro"==r?h(".change-item-ratio",".grid-stack-item").show():h(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.options.verticalMargin=i,GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(i,!1),GridPlusSetting.grid.removeAll(),_.each(o,function(t){s=GridPlusSetting.grid.addWidget(h('<div><div class="grid-stack-item-content" /></div>'),t.x,t.y,t.width,t.height),GridPlusSetting.registerRemoveGridStackItem(s),GridPlusSetting.registerChangeItemStyle(s),GridPlusSetting.registerChangeItemRatio(s),GridPlusSetting.processInitItemStyle(s,t.skin,t.item_width_ratio,t.item_height_ratio)},this)},registerRemoveGridStackItem:function(t){h(".grid-stack-item-content",t).append('<a class="remove-item" title="Remove item"><i class="fa fa-trash-o"></i></a>'),h("a",t).off("click").on("click",function(){GridPlusSetting.grid.removeWidget(t),GridPlusSetting.processUpdateItemPerPage(-1)})},registerChangeItemRatio:function(t){h(".grid-stack-item-content",t).append('<div class="change-item-ratio"><a href="javascript:;" title="Change item ratio"><i class="fa fa-qrcode"></i></a>'),h(".change-item-ratio a",t).off("click").on("click",function(){var n=h(this).closest(".grid-stack-item"),u=n.children(".grid-stack-item-content"),t=wp.template("bg-prompt-change-item-height-dialog"),i=n.attr("data-item-height-ratio"),e=n.attr("data-item-width-ratio");void 0!==i&&""!=i||(i=1),void 0!==e&&""!=e||(e=1),h("body").append(t({height_ratio:i,width_ratio:e})),h("a.close-popup",".bg-popup-change-item-height").on("click",function(){h(".bg-popup-change-item-height").remove()}),h(".apply-change-item-height",".bg-popup-change-item-height").on("click",function(){var t=h(".txt_height",".bg-popup-change-item-height").val(),i=h(".txt_width",".bg-popup-change-item-height").val(),e=u.width(),a=u.height(),l=n.attr("data-gs-height"),r=Math.ceil(a/l),o=0,s=0;t=parseInt(t)<=0?1:t,i=parseInt(i)<=0?1:i,""!=t&&""!=i&&(n.attr("data-item-height-ratio",t),n.attr("data-item-width-ratio",i),e=parseInt(e),t=parseInt(t),i=parseInt(i),s=Math.floor(e*(t/i)),o=Math.floor(s/r),GridPlusSetting.processChangeItemHeight(n,o)),h(".bg-popup-change-item-height").remove()})})},registerChangeItemStyle:function(i){h(".grid-stack-item-content",i).append('<div class="change-style"><a href="javascript:;" title="Change skin"><i class="fa fa-paint-brush"></i></a>'),h(".change-style a",i).off("click").on("click",function(){GridPlusSetting.showPopupSkin(function(t){GridPlusSetting.processInitItemStyle(i,t)})})},registerChangeTab:function(){var i=".grid-plus-wrap .nav-tabs",e=".grid-plus-wrap .content-wrap";h("a",i).on("click",function(){var t=h(this).attr("data-section-id");void 0!==t&&(h("li",i).removeClass("tab-current"),void 0!==h(this).attr("data-external")?h('a[data-section-id="'+t+'"]',i).parent().addClass("tab-current"):h(this).parent().addClass("tab-current"),h("section",e).hide(),h("#"+t,e).show())})},registerGallery:function(){h(".sf-field-gallery-inner",".grid-plus-wrap").each(function(){new SF_GalleryClass(h(this)).init()})},estimateItemInfo:function(){var t=parseInt(GridPlusSetting.layout_col.val()),i=Math.floor(12/t),e=Math.floor(12/t),a=GridPlusSetting.layout_type.val(),l=GridPlusSetting.layout_gutter.val(),r=h(".grid-stack-container").width(),o=Math.floor(parseInt(r)/t),s=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),n=GridPlusSetting.vars.grid_stack.attr("data-width-ratio"),u=12;if("grid"!=a&&"masonry"!=a&&5!=t||(i=1,u=t),"grid"==a)e=void 0!==s&&void 0!==n&&""!=n&&""!=s?Math.floor(o*(s/n)/GridPlusSetting.options.cellHeight):Math.floor(o/GridPlusSetting.options.cellHeight);else switch(t){case 2:e=0<l?15:40;break;case 3:case 4:e=0<l?15:30;break;case 5:case 6:e=0<l?10:20}return{width:i,height:e,system_col:u,col:t}},processSaveGrid:function(t){if("carousel"!=GridPlusSetting.layout_type.val()&&"justified"!=GridPlusSetting.layout_type.val()){if(void 0===GridPlusSetting.grid||0==h(".grid-stack-item",".grid-stack").length)return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout before save");if(!GridPlusSetting.isValidateLayout())return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout when change layout type before save")}GridPlusUtil.showLoading("Save Grid Settings"),"metro"==GridPlusSetting.layout_type.val()?(GridPlusSetting.layout_item_per_page=h("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=h("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=h("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=h("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=h("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=h("#metro_layout_page_loadmore_text")):(GridPlusSetting.layout_item_per_page=h("#layout_item_per_page"),GridPlusSetting.layout_total_items=h("#layout_total_items"),GridPlusSetting.layout_pagination_type=h("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=h("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=h("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=h("#layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=h("#attachment_layout_authors"),GridPlusSetting.layout_order=h("#attachment_layout_order"),GridPlusSetting.layout_order_by=h("#attachment_layout_order_by"));var i="thumbnail";0<h('.grid-post-item[data-skin-selected="1"]',".list-skins").length&&(i=h('.grid-post-item[data-skin-selected="1"]',".list-skins").closest(".skin-item").attr("data-skin"));var e="all";"post"==GridPlusSetting.layout_source.val()?(e=h("#layout_source_filter").val(),GridPlusSetting.layout_order=h("#layout_post_order"),GridPlusSetting.layout_order_by=h("#layout_post_order_by")):"product"==GridPlusSetting.layout_source.val()?(e=h("#layout_product_source_filter").val(),GridPlusSetting.layout_order=h("#layout_product_order"),GridPlusSetting.layout_order_by=h("#layout_product_order_by")):(GridPlusSetting.layout_order=h("#layout_order"),GridPlusSetting.layout_order_by=h("#layout_order_by"));var a=GridPlusSetting.layout_carousel_next_text.val(),l=GridPlusSetting.layout_carousel_prev_text.val(),r=GridPlusSetting.layout_page_loadmore_text.val(),o=GridPlusSetting.layout_page_next_text.val(),s=GridPlusSetting.layout_page_prev_text.val();void 0!==a&&(a=a.replace(/"/g,"&quot;")),void 0!==l&&(l=l.replace(/"/g,"&quot;")),void 0!==r&&(r=r.replace(/"/g,"&quot;")),void 0!==o&&(o=o.replace(/"/g,"&quot;")),void 0!==s&&(s=s.replace(/"/g,"&quot;"));var n=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),u=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==n&&""!=n&&0!=n||(n=1),void 0!==u&&""!=u&&0!=u||(u=1),GridPlusSetting.layout_gutter.val()<0&&GridPlusSetting.layout_gutter.val(0),70<GridPlusSetting.layout_gutter.val()&&GridPlusSetting.layout_gutter.val(70),GridPlusSetting.vars.custom_content_numb=0;var d=GridPlusSetting.vars.grid_stack.height(),g=_.map(h(".grid-stack > .grid-stack-item"),function(t){var i=(t=h(t)).data("_gridstack_node");"custom-content"==t.attr("data-skin")&&GridPlusSetting.vars.custom_content_numb++;var e=t.attr("data-item-width-ratio"),a=t.attr("data-item-height-ratio");return void 0!==e&&void 0!==a||(e=t.children(".grid-stack-item-content").width(),a=t.height()),e=e<=0?1:e,a=a<=0?1:a,{x:i.x,y:i.y,width:i.width,height:i.height,skin:t.attr("data-skin"),skin_css:t.attr("data-skin-css"),template:t.attr("data-skin-template"),item_width_ratio:e,item_height_ratio:a}},this),c={id:GridPlusSetting.layout_id.val(),name:GridPlusSetting.layout_name.val(),height:d,height_ratio:n,width_ratio:u,type:GridPlusSetting.layout_type.val(),columns:GridPlusSetting.layout_col.val(),gutter:GridPlusSetting.layout_gutter.val(),item_per_page:GridPlusSetting.layout_item_per_page.val(),total_item:GridPlusSetting.layout_total_items.val(),fix_item_height:GridPlusSetting.layout_fix_item_height.is(":checked"),crop_image:GridPlusSetting.layout_crop_image.is(":checked"),disable_link:GridPlusSetting.layout_disable_link.is(":checked"),custom_content_enable:GridPlusSetting.layout_custom_content_enable.is(":checked"),custom_content:GridPlusSetting.layout_custom_content.val(),custom_content_numb:GridPlusSetting.vars.custom_content_numb,loop:GridPlusSetting.layout_loop.is(":checked"),center:GridPlusSetting.layout_center.is(":checked"),justified_row_height:GridPlusSetting.layout_justified_row_height.val(),main_skin:i,carousel_rtl:GridPlusSetting.layout_carousel_rtl.is(":checked"),carousel_height_ratio:GridPlusSetting.layout_carousel_height_ratio.val(),carousel_width_ratio:GridPlusSetting.layout_carousel_width_ratio.val(),carousel_next_text:a,carousel_prev_text:l,carousel_total_items:GridPlusSetting.layout_carousel_total_items.val(),carousel_desktop_large_col:GridPlusSetting.layout_carousel_desktop_large_col.val(),carousel_desktop_large_width:GridPlusSetting.layout_carousel_desktop_large_width.val(),carousel_desktop_medium_col:GridPlusSetting.layout_carousel_desktop_medium_col.val(),carousel_desktop_medium_width:GridPlusSetting.layout_carousel_desktop_medium_width.val(),carousel_desktop_small_col:GridPlusSetting.layout_carousel_desktop_small_col.val(),carousel_desktop_small_width:GridPlusSetting.layout_carousel_desktop_small_width.val(),carousel_tablet_col:GridPlusSetting.layout_carousel_tablet_col.val(),carousel_tablet_width:GridPlusSetting.layout_carousel_tablet_width.val(),carousel_tablet_small_col:GridPlusSetting.layout_carousel_tablet_small_col.val(),carousel_tablet_small_width:GridPlusSetting.layout_carousel_tablet_small_width.val(),carousel_mobile_col:GridPlusSetting.layout_carousel_mobile_col.val(),carousel_mobile_width:GridPlusSetting.layout_carousel_mobile_width.val(),autoplay:GridPlusSetting.layout_autoplay.is(":checked"),autoplay_hover_pause:GridPlusSetting.layout_autoplay_hover_pause.is(":checked"),autoplay_time:GridPlusSetting.layout_autoplay_time.val(),show_dot:GridPlusSetting.layout_show_dot.is(":checked"),show_nav:GridPlusSetting.layout_show_nav.is(":checked"),carousel_nav_position:GridPlusSetting.layout_carousel_nav_position.val(),carousel_nav_style:GridPlusSetting.layout_carousel_nav_style.val(),animation_type:GridPlusSetting.layout_animation_type.val(),pagination_type:GridPlusSetting.layout_pagination_type.val(),page_next_text:o,page_prev_text:s,page_loadmore_text:r,category_color:GridPlusSetting.layout_category_color.val(),category_hover_color:GridPlusSetting.layout_category_hover_color.val(),no_image_background_color:GridPlusSetting.layout_no_image_bg_color.val(),background_color:GridPlusSetting.layout_bg_color.val(),icon_color:GridPlusSetting.layout_icon_color.val(),icon_hover_color:GridPlusSetting.layout_icon_hover_color.val(),title_color:GridPlusSetting.layout_title_color.val(),title_hover_color:GridPlusSetting.layout_title_hover_color.val(),excerpt_color:GridPlusSetting.layout_excerpt_color.val(),custom_css:GridPlusSetting.layout_custom_css.getValue()},p={post_type:GridPlusSetting.layout_source.val(),source_type:GridPlusSetting.source_type.val(),grid_gallery:GridPlusSetting.grid_gallery.val(),categories:GridPlusSetting.layout_category.val(),show_category:GridPlusSetting.layout_show_category.val(),cate_multi_line:GridPlusSetting.layout_cate_multi_line.is(":checked"),authors:GridPlusSetting.layout_authors.val(),include_ids:GridPlusSetting.layout_include_ids.val(),exclude_ids:GridPlusSetting.layout_exclude_ids.val(),source_filter:e,attachment_type:GridPlusSetting.attachment_type.val(),custom_urls:GridPlusSetting.custom_urls.val(),order:GridPlusSetting.layout_order.val(),order_by:GridPlusSetting.layout_order_by.val()},y=h(t).parent().attr("data-ajax-url");g=_.sortBy(g,function(t){return t.y}),g=GridStackUI.Utils.sort(g),h.ajax({url:y,type:"POST",data:{action:"grid_plus_save_layout",grid_config:c,grid_data_source:p,grid_layout:g},success:function(t){void 0!==(t=JSON.parse(t)).code&&"-1"==t.code?(GridPlusUtil.closeLoading(0),GridPlusUtil.popupAlert("fa fa-exclamation-triangle",t.message)):(GridPlusSetting.layout_id.val(t.id),GridPlusSetting.layout_shortcode.val('[grid_plus name="'+GridPlusSetting.layout_name.val()+'"]'),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Grid setting saved"),GridPlusUtil.closeLoading())},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when save information"),GridPlusUtil.closeLoading()}})},processGenerateLayout:function(){var t=h("#layout_name").val(),i=h("#layout_type").val(),e=h("#layout_col").val(),a=h("#layout_item_per_page").val(),l=h("#layout_total_items").val(),r=h("#layout_gutter").val(),o="grid-stack-"+e;"show_all"==h("#layout_pagination_type").val()&&(a=2*e),h("#grid_id",".grid-plus-layout").val(),h("#grid_name",".grid-plus-layout").val(t),h("#grid_type",".grid-plus-layout").val(i),h("#grid_col",".grid-plus-layout").val(e),h("#grid_gutter",".grid-plus-layout").val(r),h("#grid_item_per_page",".grid-plus-layout").val(a),h("#grid_items",".grid-plus-layout").val(l);for(var s=1;s<=12;s++)GridPlusSetting.vars.grid_stack.removeClass("grid-stack-"+s);"metro"==i&&5!=e||GridPlusSetting.vars.grid_stack.addClass(o),e=parseInt(e),a=parseInt(a),GridPlusSetting.initGridStack(i,e,a,r),GridPlusSetting.initGridMoveAndResize(i)},processAddItem:function(t,i,e,a){var l=h(".grid-stack-item:last-child"),r=0,o=0,s=t,n=0,u=0,d=h(".grid-stack-item").length;void 0!==l&&0<l.length&&(r=l.attr("data-gs-y"),o=l.attr("data-gs-x"),s=l.attr("data-gs-width"),d%e==0?(n=0,u=Math.floor(d/e)*i):(u=r,n=parseInt(o)+parseInt(s)));var _={x:n,y:u,width:t,height:i};void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid||(GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"));var g=GridPlusSetting.grid.addWidget(h('<div><div class="grid-stack-item-content stack-item-has-bg"/></div>'),_.x,_.y,_.width,_.height,!1);if(void 0===a||""==a){var c=h('.grid-post-item[data-skin-selected="1"]',".list-skins");a="thumbnail",0<c.length&&(a=c.closest(".skin-item").attr("data-skin"))}GridPlusSetting.registerRemoveGridStackItem(g),GridPlusSetting.registerChangeItemStyle(g),GridPlusSetting.registerChangeItemRatio(g),GridPlusSetting.processInitItemStyle(g,a,1,1)},processInitItemStyle:function(t,i,e,a){var l,r,o,s,n=h(".grid-stack-item-content",t),u=h('li[data-skin="'+i+'"]',".list-skins"),d=h(".grid-post-item",u);0==d.length&&(u=h("li:first-child",".list-skins"),d=h(".grid-post-item:first-child",".list-skins")),l=u.attr("data-skin"),o=u.attr("data-skin-css"),r=u.attr("data-skin-template"),d=d.clone(),void 0!==(s=h(".thumbnail-image",d).attr("data-img"))&&""!=s&&(h(".thumbnail-image img",d).remove(),h(".thumbnail-image",d).css("background-image",'url("'+s+'")')),h("a.select-skin",d).remove(),t.fadeOut(function(){0<h(".grid-post-item",t).length&&h(".grid-post-item",t).remove(),t.attr("data-skin",l),t.attr("data-skin-css",o),t.attr("data-skin-template",r),t.attr("data-item-height-ratio",a),t.attr("data-item-width-ratio",e),n.append(d),t.fadeIn()})},processUpdateItemPerPage:function(t){var i=h("#layout_item_per_page").val();h("#layout_item_per_page").val(parseInt(i)+t),h("#grid_item_per_page",".grid-plus-layout").val(parseInt(i)+t)},processEditLayout:function(){GridPlusUtil.showLoading("Loading layout information"),h.ajax({url:grid_script_data.ajax_url,type:"POST",data:{action:"grid_plus_get_info",grid_id:grid_script_data.grid_id},success:function(t){var i=JSON.parse(t);if("-1"==typeof i.code)return GridPlusUtil.closeLoading(0),void GridPlusUtil.popupAlert("fa fa-exclamation-triangle",i.message);if(void 0!==i.grid_config){var e=h('.skin-item[data-skin="'+i.grid_config.main_skin+'"]',".list-skins");0<e.length&&(h(".grid-post-item",e).attr("data-skin-selected",1),h(".select-skin",e).html('<i class="fa fa-check-square-o"></i>Selected'))}GridPlusSetting.initGridStackEdit(i.grid_layout,i.grid_config.gutter,i.grid_config.columns,i.grid_config.height_ratio,i.grid_config.width_ratio,i.grid_config.type),GridPlusSetting.initGridMoveAndResize(i.grid_config.type),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Information has been loaded"),GridPlusUtil.closeLoading(500)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when load information"),GridPlusUtil.closeLoading()}})},processRebindListGrid:function(t){var i=wp.template("list-grid-template");h("tr","#table_list_grid tbody").empty(),void 0!==t&&0<t.length&&h("tbody","#table_list_grid").append(i(t)),GridPlusSetting.registerGridAction()},processSearch:function(t,i,e){GridPlusUtil.showLoading(t),h.ajax({url:i,type:"POST",data:{action:"grid_plus_get_list",grid_name:e},success:function(t){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Binding grid"),GridPlusUtil.closeLoading(500),t=JSON.parse(t),GridPlusSetting.processRebindListGrid(t),GridPlusSetting.is_search=0},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading(),GridPlusSetting.is_search=0}})},processChangeHeight:function(t){var i=0,e=0,a=0,l=0;h(".grid-stack-item").each(function(){l=parseInt(h(this).attr("data-gs-height")),i=t-l,e=parseInt(h(this).attr("data-gs-y")),a=parseInt(h(this).attr("data-gs-width")),h(this).attr("data-gs-height",t),0<e&&h(this).attr("data-gs-y",e+i),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(h(this),a,t)}),void 0!==GridPlusSetting.grid&&(GridPlusSetting.grid.batchUpdate(),GridPlusSetting.grid.commit())},processChangeItemHeight:function(t,i){var e,a,l;e=i-parseInt(t.attr("data-gs-height")),a=parseInt(t.attr("data-gs-y")),l=parseInt(t.attr("data-gs-width")),t.attr("data-gs-height",i),0<a&&h(this).attr("data-gs-y",a+e),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(t,l,i)},isValidateLayout:function(){var t=GridPlusSetting.layout_type.val(),i=(GridPlusSetting.layout_col,h(".grid-stack-item"));if("grid"==t||"masonry"==t)for(var e=0;e<i.length;e++)if(0<h(i[e]).prev().length&&parseInt(h(i[e]).attr("data-gs-width"))!=parseInt(h(i[e]).prev().attr("data-gs-width")))return!1;return!0},showPopupSkin:function(i){var t=h("#list_skins").clone(!0),e=h('<div class="grid-plus-container"></div>'),a=h('<div class="bg-popup-skins"></div>');h("li",t).removeClass("col-md-3").addClass("col-md-4"),e.append(t),a.append(e),e.append('<a href="javascript:;" class="close-popup"><i class="fa fa-times"></i></a>'),h(".select-skin i",e).removeClass("fa fa-check-square-o").addClass("fa fa-square-o"),h("body").append(a),h(".grid-plus-container .grid-plus-layout",a).perfectScrollbar({wheelSpeed:.5,suppressScrollX:!0}),h("a.close-popup",a).on("click",function(){a.remove()}),h("a.select-skin",a).off("click").on("click",function(t){return a.remove(),i&&i(h(this).closest(".skin-item").attr("data-skin")),t.preventDefault(),!1})},animation:function(){h("#layout_animation_type").on("change",function(){var t=h(".animation-wrap");t.attr("class","animation-wrap animated "+h(this).val()),setTimeout(function(){t.attr("class","animation-wrap")},1e3)}),h(".preview-animation").on("click",function(){h("#layout_animation_type").trigger("change")})},execCustomContent:function(){var t=h("#layout_type").val(),i=h("#layout_custom_content_enable").is(":checked"),e=h('[data-skin="custom-content"]',".list-skins");"metro"!=t||"true"!=i&&!i?(e.css("display","none"),"1"==h(".grid-post-item",e).attr("data-skin-selected")&&h(".select-skin",'.list-skins [data-skin="thumbnail"]').trigger("click")):e.css("display","inline-block")}},h(document).ready(function(){GridPlusSetting.init()})}(jQuery);